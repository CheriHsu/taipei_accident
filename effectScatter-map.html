<!-- Author Cheri Hsu on 2019.01 -->
<!-- Data from Taipei City 2014-2017 -->
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>台北市交通事故統計</title>

    <meta charset="utf-8">
    <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />

    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.3.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.3.0/mapbox-gl-geocoder.css' type='text/css' />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>

    <script type="text/javascript" src="https://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>


    <script src="https://use.typekit.net/dli0dtt.js"></script> <!-- font-family -->
    <script>try{Typekit.load({ async: true });}catch(e){}</script> <!-- font-family -->

    <style>
        body { 
            margin:0; 
            padding:0; 
            font-family:"source-han-sans-traditional", arial, 微軟正黑體, Microsoft JhengHei,sans-serif;
            /* background-color: #444342; */
            }
        p{
            font-size: 14px;
        }
        #map { 
            position:absolute; 
            top:0; 
            bottom:0; 
            width:75%;
            height: 100%;
            float: left;
        }

        h1 {
            font-size: 20px;
            line-height: 30px;
        }

        h2 {
            font-size: 14px;
            line-height: 20px;
            margin-bottom: 10px;
        }

        a {
            text-decoration: none;
            color: #2dc4b2;
        }

        #console {
            position: absolute;
            width: 240px;
            margin: 10px;
            padding: 10px 20px;
            background-color: white;
        }

        .session {
            margin-bottom: 20px;
        }

        .row {
            height: 12px;
            width: 100%;
        }

        .colors {
            background: linear-gradient(to right, #2dc4b2, #3bb3c3, #669ec4, #8b88b6, #a2719b, #aa5e79);
            margin-bottom: 5px;
        }

        .label {
            width: 14%;
            display: inline-block;
            text-align: center;
        }

        /* menu */
        #menu {
            background: #fff;
            padding: 10px 40px 20px;
            /* position: absolute; */
            z-index: 1;
            top: 10px;
            right: 10px;
            /* border-radius: 3px; */
            /* width: 120px; */
            /* border: 1px solid rgba(0,0,0,0.4); */
            font-family: 'Open Sans', sans-serif;
        }

        #menu a {
            font-size: 13px;
            color: #404040;
            /* display: block; */
            margin: 5px;
            padding: 0;
            padding: 10px;
            text-decoration: none;
            border-bottom: 1px solid rgba(0,0,0,0.25);
            text-align: center;
            border-radius: 3px;
        }

        #menu a:last-child {
            border: none;
        }

        #menu a:hover {
            background-color: #f8f8f8;
            color: #404040;
        }

        #menu a.active {
            background-color: #3887be;
            color: #ffffff;
        }

        #menu a.active:hover {
            background: #3074a4;
        }
        
        /* search input */
        .geocoder {
            position:absolute;
            z-index:1;
            width:50%;
            left:50%;
            margin-left:-25%;
            top:20px;
        }
        /* .mapboxgl-ctrl-geocoder { min-width:100%; } */

        /* chartjs */
        section{
            width: 22%;
            text-align: center;
            font-size: 14px;
            float: right;
            padding: 10px;
            /* color:#fff; */
        }
        .wrapper{
            width: 1200px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            font-family: "Noto Sans TC","Microsoft JhengHei UI","Microsoft JhengHei";
            }
        .style1{
            margin: 5% 0 8%;
        }
        .style2{
            margin: 0 0 5%;
        }
        @media (max-width: 1200px){
            .wrapper{
            width: 100%;
            }
        }

        .right_section{
            font-weight: 900;
            height: 100vh;
            float: right;
        }

        .title{
            font-weight: 900;
            height: 100%;
        }

        #accident_position_row, #age_gander_row{
            width: 100%;
            float: left;
        }
        .box{
            padding: 10px;
        }
    </style>
</head>

<body style="height: 100%; margin: 0">
    <!-- 台北市交通事故統計 -->
    <div id="map"></div>
    <div id='geocoder' class='geocoder'></div>
    <div id='console'>
        <!-- vehicle collisions -->
        <h1>台北市交通事故統計<br>Traffic Accidents in Taipei City</h1>
        <p>Data: <a href='https://data.gov.tw/dataset/73925'>
            Vehicles collision injuries and deaths交通事故資料來源</a> ,<br>2017
        </p>

        <!-- menu -->
        <h2>顯示 Display:</h2>
        <nav id="menu">
            <!-- append
            <a href="#" class="active">Heatmap</a>
            <a href="#" class="active">Point</a> 
            -->
        </nav>

        <!-- labels -->
        <div class='session'>
            <h2>Casualty 死傷人數</h2>
            <div class='row colors'>
            </div>
            <div class='row labels'>
                <div class='label'>0</div>
                <div class='label'>1</div>
                <div class='label'>2</div>
                <div class='label'>3</div>
                <div class='label'>4</div>
                <div class='label'>5+</div>
            </div>
        </div>

        <!-- sliderbar -->
        <div class='session' id='sliderbar'>
            <h2>發生時辰 Hour: <label id='active-hour'>12PM</label></h2>
            <input id='slider' class='row' type='range' min='0' max='23' step='1' value='12' />
        </div>
    </div>

	<section class="right_section">
        <span>2014-2017 Traffic accident rate<br>交通事故率</span>

        <p style="text-align: left;">年度受傷人數</p>
		<canvas class="style1" id="injured"></canvas>
        <p style="text-align: left;">年度死亡人數</p>
        <canvas class="style2" id="death"></canvas>
        
	</section>
    <section id="accident_position_row">
        <!-- 天氣 -->
        <!-- <div id="weather_dom" style="width: 47%; height: 400px; float: left;"></div>  -->

        <!-- 事故道路型態比例 -->
        <div id="pie_dom" style="width: 47%; height: 400px; float: left;"></div> 

        <!-- 汽機車死亡人數 -->
        <div id="container" style="width: 47%; height: 400px; float: left;"></div>
    </section>
    <section id="age_gander_row">
        <div class="title">年度男女年齡事故比例</div>
        <div class="box" id="box" style="width: 47%; height: 400px; float: left"></div>
        <div class="box" id="box2" style="width: 47%; height: 400px; float: left"></div>
        <div class="box" id="box3" style="width: 47%; height: 400px; float: left"></div>
        <div class="box" id="box4" style="width: 47%; height: 400px; float: left"></div>
    </section>

    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiY2hlcmloc3UiLCJhIjoiY2puemxzM2M4MTBoMTNrcXB2OW53bTZlYyJ9.dGOT6ydOwADgu2qMaCQWTw';
        $( document ).ready(function() {
            
            var map = new mapboxgl.Map({
                container: 'map', // map id
                // style: 'mapbox://styles/mapbox/streets-v9',
                // style: 'mapbox://styles/mapbox/light-v9',
                style: 'mapbox://styles/mapbox/dark-v9',
                center: [121.602152, 25.048374], // starting position
                zoom: 13,// zoom: 2 // starting zoom
                localIdeographFontFamily: "'Noto Sans', 'Noto Sans CJK SC', sans-serif"
            })
            
            // search input
            var geocoder = new MapboxGeocoder({
                accessToken: mapboxgl.accessToken
            });
            document.getElementById('geocoder').appendChild(geocoder.onAdd(map));


            map.on('load', function () {

                // FullscreenControl
                map.addControl(new mapboxgl.FullscreenControl());

                // Add zoom and rotation controls to the map.
                map.addControl(new mapboxgl.NavigationControl());

                // Add geolocate control to the map.
                // map.addControl(new mapboxgl.GeolocateControl({
                //     positionOptions: {
                //         enableHighAccuracy: true
                //     },
                //     trackUserLocation: true
                // }));

                //for Heatmap and Point
                map.addSource('accidents', {
                    "type": "geojson",
                    "data": "./convertcsv.geojson"
                });        
                
                
                $.ajax({
                    url: "./convertcsv.geojson",
                    dataType: "json",
                    success: function (result) {
                        console.log(result.features)

                        // =======================事故道路型態比例 for accidents position Pie chart=======================
                        var accident_position_data = [];
                        var accident_position_1 = 0,
                            accident_position_2 = 0,
                            accident_position_3 = 0,
                            accident_position_4 = 0,
                            accident_position_5 = 0,
                            accident_position_6 = 0,
                            accident_position_7 = 0,
                            accident_position_8 = 0,
                            accident_position_9 = 0,
                            accident_position_10 = 0,
                            accident_position_11 = 0,
                            accident_position_12 = 0,
                            accident_position_13 = 0,
                            accident_position_14 = 0,
                            accident_position_15 = 0,
                            accident_position_16 = 0,
                            accident_position_17 = 0,
                            accident_position_18 = 0,
                            accident_position_19 = 0,
                            accident_position_20 = 0,
                            accident_position_21 = 0,
                            accident_position_22 = 0;
                            
                        //計算總和
                        $.each(result.features, function (index, item) {
                //             accident_position.push(item.properties.Position);
                            switch(item.properties.Position){
                                case 1:
                                    accident_position_1 = accident_position_1 + 1;
                                    break;
                                case 2:
                                    accident_position_2 = accident_position_2 + 1;
                                    break;
                                case 3:
                                    accident_position_3 = accident_position_3 + 1;
                                    break;
                                case 4:
                                    accident_position_4 = accident_position_4 + 1;
                                    break;
                                case 5:
                                    accident_position_5 = accident_position_5 + 1;
                                    break;
                                case 6:
                                    accident_position_6 = accident_position_6 + 1;
                                    break;
                                case 7:
                                    accident_position_7 = accident_position_7 + 1;
                                    break;
                                case 8:
                                    accident_position_8 = accident_position_8 + 1;
                                    break;
                                case 9:
                                    accident_position_9 = accident_position_9 + 1;
                                    break;
                                case 10:
                                    accident_position_10 = accident_position_10 + 1;
                                    break;
                                case 11:
                                    accident_position_11 = accident_position_11 + 1;
                                    break;
                                case 12:
                                    accident_position_12 = accident_position_12 + 1;
                                    break;
                                case 13:
                                    accident_position_13 = accident_position_13 + 1;
                                    break;
                                case 14:
                                    accident_position_14 = accident_position_14 + 1;
                                    break;
                                case 15:
                                    accident_position_15 = accident_position_15 + 1;
                                    break;
                                case 16:
                                    accident_position_16 = accident_position_16 + 1;
                                    break;
                                case 17:
                                    accident_position_17 = accident_position_17 + 1;
                                    break;
                                case 18:
                                    accident_position_18 = accident_position_18 + 1;
                                    break;
                                case 19:
                                    accident_position_19 = accident_position_19 + 1;
                                    break;
                                case 20:
                                    accident_position_20 = accident_position_20 + 1;
                                    break;
                                case 21:
                                    accident_position_21 = accident_position_21 + 1;
                                    break;
                                case 22:
                                    accident_position_22 = accident_position_22 + 1;
                                    break;
                            }
                        });

                        accident_position_data = [
                            {value:accident_position_1, name:'交叉路口內'},
                            {value:accident_position_2, name:'交叉口附近'},
                            {value:accident_position_3, name:'機車待轉區'},
                            {value:accident_position_4, name:'機車停等區'},
                            {value:accident_position_5, name:'交通島(含槽化線)'},
                            {value:accident_position_6, name:'迴轉道'},
                            {value:accident_position_7, name:'快車道'},
                            {value:accident_position_8, name:'慢車道'},
                            {value:accident_position_9, name:'一般車道(未劃分快慢車道)'},
                            {value:accident_position_10, name:'公車專用道'},
                            {value:accident_position_11, name:'機車專用道'},
                            {value:accident_position_12, name:'機車優先道'},
                            {value:accident_position_13, name:'路肩、路緣'},
                            {value:accident_position_14, name:'加速車道(交流道)'},
                            {value:accident_position_15, name:'減速車道'},
                            {value:accident_position_16, name:'直線匝道'},
                            {value:accident_position_17, name:'環道匝道'},
                            {value:accident_position_18, name:'行人穿越道'},
                            {value:accident_position_19, name:'穿越道附近'},
                            {value:accident_position_20, name:'人行道'},
                            {value:accident_position_21, name:'收費站附近'},
                            {value:accident_position_22, name:'其他'}
                        ];
                         
                        // 道路型態name陣列
                        var accident_position_name = [];
                        $.each(accident_position_data, function (index, item) {
                             accident_position_name.push(item.name);
                        });
                        console.log(accident_position_name)
                        console.log(accident_position_data)

                        var pie_chart_dom = document.getElementById("pie_dom");
                        var myChart = echarts.init(pie_chart_dom);
                        pie_option = {
                            // backgroundColor: '#2c343c',
                            title: {
                                text: '2017年 事故道路型態比例',
                                right: 80,
                                textStyle:{
                                    fontSize: 14,
                                    color: '#000',
                                    fontWeight: 900
                                }
                            },
                            tooltip : {
                                trigger: 'item',
                                formatter: "{a} <br/>{b} : {c} ({d}%)"
                            },
                            visualMap: {
                                show: false,
                                min: 0,
                                max: 60000,
                                inRange: {
                                    colorLightness: [0.2, 1.5]
                                }
                            },
                            legend: {
                                        orient: 'vertical',
                                        left: 'left',
                                        data: accident_position_name
                                    },
                            series : [
                                {
                                    name:'道路型態',
                                    type:'pie',
                                    radius : '55%',
                                    center: ['50%', '70%'],
                                    data:accident_position_data.sort(function (a, b) { return a.value - b.value; }),
                                    // roseType: 'radius',
                                    label: {
                                        normal: {
                                            textStyle: {
                                                // color: 'rgba(255, 255, 255, 0.3)'
                                            }
                                        }
                                    },
                                    labelLine: {
                                        normal: {
                                            lineStyle: {
                                                // color: 'rgba(255, 255, 255, 0.3)'
                                            },
                                            smooth: 0.2,
                                            length: 10,
                                            length2: 20
                                        }
                                    },
                                    itemStyle: {
                                        normal: {
                                            // color: '#c23531',
                                            // shadowBlur: 200,
                                            // shadowColor: 'rgba(0, 0, 0, 0.5)'
                                        },
                                        emphasis: {
                                            shadowBlur: 10,
                                            shadowOffsetX: 0,
                                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                                        }
                                    },

                                    animationType: 'scale',
                                    animationEasing: 'elasticOut',
                                    animationDelay: function (idx) {
                                        return Math.random() * 200;
                                    }
                                }
                            ]
                        };
                        
                        if (pie_option && typeof pie_option === "object") {
                            myChart.setOption(pie_option, true);
                        };

                    },
                    error: function(xhr) {
                        alert(xhr.statusText)
                    }
                })

                // Heatmap
                map.addLayer({
                    "id": "Heatmap",
                    "type": "heatmap",
                    "source": "accidents",
                    "maxzoom": 22,
                    "paint": {
                        "heatmap-weight": [
                            "interpolate",
                            ["linear"],
                            ["get", "Casualty"],
                            0,1,
                            22,1
                        ],
                        "heatmap-intensity": [
                            "interpolate",
                            ["linear"],
                            ["zoom"],
                            0,1,
                            22,1
                        ],
                        "heatmap-color": [
                            "interpolate",
                            ["linear"],
                            ["heatmap-density"],
                            0,"rgba(0, 0, 255, 0)",
                            0.01,"hsla(49, 73%, 57%, 0)",
                            0.19,"hsla(54, 100%, 50%, 0)",
                            0.67,"hsla(49, 100%, 50%, 0.5)",
                            0.84,"hsla(31, 99%, 55%, 0.96)",
                            1,"hsl(8, 100%, 50%)"
                        ],
                        "heatmap-radius": [
                            "interpolate",
                            ["linear"],
                            ["zoom"],
                            0,2,
                            22,2
                        ],
                        "heatmap-opacity": [
                            "interpolate",
                            ["linear"],
                            ["zoom"],
                            0,0.74,
                            22,0.74
                        ],
                    }
                }, 'waterway-label');
                
                // Point
                map.addLayer({
                    "id": "Point",
                    "type": "circle",
                    "source": "accidents",
                    // "minzoom": 11,
                    "paint": {
                        'circle-radius': [
                            'interpolate',
                            ['linear'],
                            ['number', ['get', 'Casualty']],
                                0, 0.1,
                                5, 24
                        ],
                        'circle-color': [
                            'interpolate',
                            ['linear'],
                            ['number', ['get', 'Casualty']],
                                0, '#2DC4B2',
                                1, '#3BB3C3',
                                2, '#669EC4',
                                3, '#8B88B6',
                                4, '#A2719B',
                                5, '#AA5E79'
                        ],
                        'circle-opacity': 0.3
                    }
                }, 'admin-2-boundaries-dispute');


                // slider interactivity
                document.getElementById('slider').addEventListener('input', function(e) {
                var hour = parseInt(e.target.value);
                // update the map
                map.setFilter('Point', ['==', ['number', ['get', 'Hour']], hour]);
                // converting 0-23 hour to AMPM format
                var ampm = hour >= 12 ? 'PM' : 'AM';
                var hour12 = hour % 12 ? hour % 12 : 12;
                // update text in the UI
                document.getElementById('active-hour').innerText = hour12 + ampm;

                });
            });

            //click on tree to view Casualty in a popup
            map.on('click', 'Point', function (e) {
                new mapboxgl.Popup()
                    .setLngLat(e.features[0].geometry.coordinates)
                    .setHTML('<b>月份 Month:</b> '+ e.features[0].properties.Month + 
                             '月<br><b>死亡 Death:</b> '+ e.features[0].properties.Killed +
                             '人<br><b>受傷 Injured:</b> '+ e.features[0].properties.Injured + 
                             '人<br><b>死傷總和 Casualty:</b> '+ e.features[0].properties.Casualty + '人')
                    .addTo(map);
            });

            // change layer
            var toggleableLayerIds = [ 'Heatmap', 'Point' ];
            for (var i = 0; i < toggleableLayerIds.length; i++) {
                var id = toggleableLayerIds[i];

                var link = document.createElement('a');
                link.href = '#';
                link.className = 'active';
                link.textContent = id;

                link.onclick = function (e) {
                    var clickedLayer = this.textContent;
                    e.preventDefault();
                    e.stopPropagation();

                    var visibility = map.getLayoutProperty(clickedLayer, 'visibility');

                    if (visibility === 'visible') {
                        map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                        this.className = '';
                        if (clickedLayer === "Point") {
                            $('.session').hide();
                        }
                    } else {
                        this.className = 'active';
                        map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
                        if (clickedLayer === "Point") {
                            $('.session').show();
                        }
                    }
                };

                var layers = document.getElementById('menu');
                layers.appendChild(link);
            }


        });
    </script>
    
    <!-- chartjs -->
    <script>
		var ctx = document.getElementById('injured').getContext('2d');
		var chart = new Chart(ctx, {
		    type: 'line',

		    data: {
		        labels: ["2014", "2015", "2016", "2017"],
		        datasets: [{
		            label: "受傷人數",
		            backgroundColor: 'rgb(80,193,233)',
		            borderColor: 'rgb(80,193,233)',
		            data: [70288, 70454, 71797, 70719],
		        }]
		    },

		    options: {	
				scales: {
					xAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: '年份'
						}
					}],
					yAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: '人數'
						}
					}]
				}
			}
		});
	</script>
	<script>
		var ctx = document.getElementById('death').getContext('2d');
		var chart = new Chart(ctx, {
		    type: 'line',

		    data: {
		        labels: ["2014", "2015", "2016", "2017"],
		        datasets: [{
		            label: "死亡人數",
		            backgroundColor: 'rgb(255, 99, 132)',
		            borderColor: 'rgb(255, 99, 132)',
		            data: [214, 210, 220, 275],
		        }]
		    },
		    
		     options: {	
				scales: {
					xAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: '年份'
						}
					}],
					yAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: '人數'
						}
					}]
				}
			}
		});
    </script>
    
    <!-- echarts -->
    <script>
        // 汽機車死亡人數
        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        option = {
            title: {
                text: '汽機車死亡人數',
                left: 'center',
                textStyle:{
                    fontSize: 14,
                    fontWeight: 900
                }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            legend: {
                data: ['汽車', '機車'],
                right: 0
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                name: '人數',
                nameLocation: 'middle',
                nameGap: 15,
                type: 'value',
                boundaryGap: [0, 0.01]
            },
            yAxis: {
                name: '年份',
                type: 'category',
                data: ['106年','105年','104年','103年']
            },
            series: [
                {
                    name: '汽車',
                    type: 'bar',
                    data: [93, 72, 75, 73]
                },
                {
                    name: '機車',
                    type: 'bar',
                    data: [77, 71, 66, 69]
                }
            ]
        };
        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        };

        // 汽車事故
        // var dom2 = document.getElementById("container2");
        // var myChart2 = echarts.init(dom2);
        // var option2 = {
        //     title: {
        //         text: '汽車事故',
        //         textStyle:{
        //             fontSize: 14,
        //             fontWeight: 900
        //         }
        //     },
        //     color: ['#DB9833'],
        //     tooltip : {
        //         trigger: 'axis',
        //         axisPointer : {            // 坐标轴指示器，坐标轴触发有效
        //             type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        //         }
        //     },
        //     grid: {
        //         left: '3%',
        //         right: '4%',
        //         bottom: '3%',
        //         containLabel: true
        //     },
        //     xAxis : [
        //         {
        //             name:'年齡',
        //             type : 'category',
        //             data : ['103年', '104年', '105年', '106年'],
        //             axisTick: {
        //                 alignWithLabel: true
        //             }
        //         }
        //     ],
        //     yAxis : [
        //         {
        //             name:'死亡人數',
        //             type : 'value'
        //         }
        //     ],
        //     series : [
        //         {
        //             name:'死亡人數',
        //             type:'bar',
        //             barWidth: '10%',
        //             data:[73, 75, 72, 93]
        //         }
        //     ]
        // };
        // if (option && typeof option === "object") {
        //     myChart2.setOption(option2, true);
        // };

    // --------------年度男女年齡----------------------------------------------------------------------------------------------------------

        var box_dom = document.getElementById("box");
        var box_myChart = echarts.init(box_dom);

        var colors = ['#5793f3', '#d14a61', '#675bba'];

        var box_option = {
            color: colors,
            title: {
                text: '103年度',
                textStyle:{
                    fontSize: 14,
                    fontWeight: 900
                }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            grid: {
                right: '20%'
            },
            toolbox: {
                feature: {
                    dataView: {show: true, readOnly: false},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            legend: {
                data:['人數']
            },
            xAxis: [
                {
                    name:'年齡',
                    type: 'category',
                    axisTick: {
                        alignWithLabel: true
                    },
                    data: ['<20','20~30','30~40','40~50','50~60','60~70','70~80','80~90','>90']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '事故人數',
                    min: 0,
                    max: 10000,
                    position: 'left',
                    axisLine: {
                        lineStyle: {
                            color: colors[0]
                        }
                    },
                    axisLabel: {
                        formatter: '{value}'
                    }
                }
            ],
            series: [
                {
                    name:'男',
                    type:'bar',
                    data:[4541, 9030, 6551, 5774, 5488, 3029, 772, 256, 68]
                },
                {
                    name:'女',
                    type:'bar',
                    data:[1659, 4221, 2995, 2453, 2274, 1260, 438, 146, 12]
                }
            ]
        };

        if (box_option && typeof box_option === "object") {
            box_myChart.setOption(box_option, true);
        };

        var dom2 = document.getElementById("box2");
        var box_myChart2 = echarts.init(dom2);

        var colors = ['#5793f3', '#d14a61', '#675bba'];
        var box_option2 = {
            color: colors,
            title: {
                text: '104年度',
                textStyle:{
                    fontSize: 14,
                    fontWeight: 900
                }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            grid: {
                right: '20%'
            },
            toolbox: {
                feature: {
                    dataView: {show: true, readOnly: false},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            legend: {
                data:['人數']
            },
            xAxis: [
                {
                    name:'年齡',
                    type: 'category',
                    axisTick: {
                        alignWithLabel: true
                    },
                    data: ['<20','20~30','30~40','40~50','50~60','60~70','70~80','80~90','>90']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '事故人數',
                    min: 0,
                    max: 10000,
                    position: 'left',
                    axisLine: {
                        lineStyle: {
                            color: colors[0]
                        }
                    },
                    axisLabel: {
                        formatter: '{value}'
                    }
                }
            ],
            series: [
                {
                    name:'男',
                    type:'bar',
                    data:[4680, 9444, 6707, 5613, 5577, 3196, 765, 247, 174]
                },
                {
                    name:'女',
                    type:'bar',
                    data:[1740, 4087, 2946, 2479, 2350, 1297, 431, 139, 14]
                }
            ]
        };

        if (box_option2 && typeof box_option2 === "object") {
            box_myChart2.setOption(box_option2, true);
        };

        var dom3 = document.getElementById("box3");
        var box_myChart3 = echarts.init(dom3);

        var colors = ['#5793f3', '#d14a61', '#675bba'];
        var box_option3 = {
            color: colors,
            title: {
                text: '105年度',
                textStyle:{
                    fontSize: 14,
                    fontWeight: 900
                }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            grid: {
                right: '20%'
            },
            toolbox: {
                feature: {
                    dataView: {show: true, readOnly: false},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            legend: {
                data:['人數']
            },
            xAxis: [
                {
                    name:'年齡',
                    type: 'category',
                    axisTick: {
                        alignWithLabel: true
                    },
                    data: ['<20','20~30','30~40','40~50','50~60','60~70','70~80','80~90','>90']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '事故人數',
                    min: 0,
                    max: 10000,
                    position: 'left',
                    axisLine: {
                        lineStyle: {
                            color: colors[0]
                        }
                    },
                    axisLabel: {
                        formatter: '{value}'
                    }
                }
            ],
            series: [
                {
                    name:'男',
                    type:'bar',
                    data:[4305, 10012, 7219, 5872, 5670, 3588, 848, 287, 932]
                },
                {
                    name:'女',
                    type:'bar',
                    data:[1568, 4406, 3035, 2657, 2306, 1476, 505, 160, 22]
                }
            ]
        };

        if (box_option3 && typeof box_option3 === "object") {
            box_myChart3.setOption(box_option3, true);
        };

        var dom4 = document.getElementById("box4");
        var box_myChart4 = echarts.init(dom4);

        var colors = ['#5793f3', '#d14a61', '#675bba'];
        var box_option4 = {
            color: colors,
            title: {
                text: '106年度',
                textStyle:{
                    fontSize: 14,
                    fontWeight: 900
                }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            grid: {
                right: '20%'
            },
            toolbox: {
                feature: {
                    dataView: {show: true, readOnly: false},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            legend: {
                data:['人數']
            },
            xAxis: [
                {
                    name:'年齡',
                    type: 'category',
                    axisTick: {
                        alignWithLabel: true
                    },
                    data: ['<20','20~30','30~40','40~50','50~60','60~70','70~80','80~90','>90']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '事故人數',
                    min: 0,
                    max: 10000,
                    position: 'left',
                    axisLine: {
                        lineStyle: {
                            color: colors[0]
                        }
                    },
                    axisLabel: {
                        formatter: '{value}'
                    }
                }
            ],
            series: [
                {
                    name:'男',
                    type:'bar',
                    data:[2725, 9344, 6212, 5313, 5323, 3697, 801, 276, 235]
                },
                {
                    name:'女',
                    type:'bar',
                    data:[992, 4049, 2751, 2393, 2258, 1611, 491, 164, 34]
                }
            ]
        };

        if (box_option4 && typeof box_option4 === "object") {
            box_myChart4.setOption(box_option4, true);
        };

    </script>
</body>

</html>